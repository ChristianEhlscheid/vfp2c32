*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="documentor.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "commonheader.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 276
	Left = 588
	Name = "Dataenvironment"
	Top = 126
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "vfp2cintelli", ;
		CursorSource = vfp2cintelli.dbf, ;
		Height = 181, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "apilinks", ;
		CursorSource = apilinks.dbf, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "groups", ;
		CursorSource = groups.dbf, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />
	
	PROCEDURE BeforeOpenTables
		SET EXCLUSIVE OFF
		SET DELETED ON
	ENDPROC

ENDDEFINE

DEFINE CLASS frmdocumentor AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="lstFunctions" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFunctions" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtExpanded" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblExpanded" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtTip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblTip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtInitflag" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblInitflag" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtReturnval" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblReturnval" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtDescrip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblDescrip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtExample" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblExample" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtApifuncs" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblApifuncs" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtRemarks" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblRemarks" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtAbbrev" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblAbbrev" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Combo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Check1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.lstParameters" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.edtTip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.lblTip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.oBrowser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmbFilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command3" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: onfilterchange
		*m: onfunctionchange
		*m: onparamchange
		*m: refreshpreview
		*m: selectfunction
		*m: updateparmtiprecords
		*p: cfilter
		*a: aparams[1,0]
	*</DefinedPropArrayMethod>

	Caption = "VFP2C32 Documentor"
	cfilter = 
	DataSession = 2
	DoCreate = .T.
	FontName = "Segoe UI"
	Height = 621
	Left = 0
	Name = "frmDocumentor"
	Top = 0
	Width = 1280

	ADD OBJECT 'cmbFilter' AS combobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "200,0", ;
		Height = 24, ;
		Left = 5, ;
		Name = "cmbFilter", ;
		Top = 27, ;
		Width = 202
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Anchor = 134, ;
		Caption = "Compile CHM", ;
		Height = 27, ;
		Left = 5, ;
		Name = "Command1", ;
		Top = 405, ;
		Width = 108
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command3' AS commandbutton WITH ;
		Anchor = 134, ;
		Caption = "Add function", ;
		Height = 27, ;
		Left = 6, ;
		Name = "Command3", ;
		Top = 438, ;
		Width = 183
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Filter:", ;
		Height = 17, ;
		Left = 5, ;
		Name = "Label1", ;
		Top = 9, ;
		Width = 87
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblFunctions' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Function List:", ;
		Height = 17, ;
		Left = 5, ;
		Name = "lblFunctions", ;
		Top = 55, ;
		Width = 87
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lstFunctions' AS listbox WITH ;
		Anchor = 5, ;
		Height = 313, ;
		Left = 5, ;
		Name = "lstFunctions", ;
		RowSource = "SELECT expanded FROM vfp2cintelli  ORDER BY expanded INTO CURSOR crsFunctions WHERE type = 'F' AND ALLTRIM(cmd) == '{vfp2c32menu}' AND IIF(EMPTY(THISFORM.cFilter), .T., groupid == THISFORM.cFilter)", ;
		RowSourceType = 3, ;
		Top = 73, ;
		Width = 202
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'Pageframe1' AS pageframe WITH ;
		Anchor = 15, ;
		ErasePage = .T., ;
		Height = 623, ;
		Left = 217, ;
		Name = "Pageframe1", ;
		PageCount = 3, ;
		Top = 0, ;
		Width = 1066, ;
		Page1.Caption = "Function", ;
		Page1.Name = "Page1", ;
		Page2.Caption = "Parameters", ;
		Page2.Name = "Page2", ;
		Page3.Caption = "Preview", ;
		Page3.Name = "Page3"
		*< END OBJECT: BaseClass="pageframe" />

	ADD OBJECT 'Pageframe1.Page1.Check1' AS checkbox WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "", ;
		ControlSource = "vfp2cintelli.threadsafe", ;
		Height = 17, ;
		Left = 998, ;
		Name = "Check1", ;
		Top = 30, ;
		Width = 15
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'Pageframe1.Page1.Combo1' AS combobox WITH ;
		BoundColumn = 2, ;
		ColumnCount = 1, ;
		ControlSource = "vfp2cintelli.groupid", ;
		Height = 23, ;
		Left = 704, ;
		Name = "Combo1", ;
		RowSource = "SELECT groupname, groupid FROM groups INTO CURSOR crsgroups ORDER BY groupname", ;
		RowSourceType = 3, ;
		Top = 27, ;
		Width = 262
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page1.edtApifuncs' AS editbox WITH ;
		Anchor = 10, ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.apifuncs", ;
		Height = 77, ;
		Left = 534, ;
		Name = "edtApifuncs", ;
		TabIndex = 20, ;
		Top = 212, ;
		Width = 515
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.edtDescrip' AS editbox WITH ;
		Anchor = 0, ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.descrip", ;
		Height = 119, ;
		Left = 9, ;
		Name = "edtDescrip", ;
		TabIndex = 16, ;
		Top = 71, ;
		Width = 515
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.edtExample' AS editbox WITH ;
		Anchor = 15, ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.example", ;
		Height = 270, ;
		Left = 534, ;
		Name = "edtExample", ;
		TabIndex = 18, ;
		Top = 314, ;
		Width = 515
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.edtRemarks' AS editbox WITH ;
		Anchor = 5, ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.remarks", ;
		Height = 270, ;
		Left = 9, ;
		Name = "edtRemarks", ;
		TabIndex = 22, ;
		Top = 314, ;
		Width = 515
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.edtReturnval' AS editbox WITH ;
		Anchor = 10, ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.returnval", ;
		Height = 119, ;
		Left = 534, ;
		Name = "edtReturnval", ;
		TabIndex = 14, ;
		Top = 71, ;
		Width = 515
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.edtTip' AS editbox WITH ;
		Anchor = 0, ;
		ControlSource = "vfp2cintelli.tip", ;
		Height = 77, ;
		Left = 9, ;
		Name = "edtTip", ;
		TabIndex = 6, ;
		Top = 212, ;
		Width = 515
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Group", ;
		Height = 17, ;
		Left = 704, ;
		Name = "Label1", ;
		TabIndex = 11, ;
		Top = 11, ;
		Width = 34, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Threadsafe", ;
		Height = 17, ;
		Left = 974, ;
		Name = "Label2", ;
		TabIndex = 11, ;
		Top = 8, ;
		Width = 63, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblAbbrev' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Abbrev", ;
		Left = 9, ;
		Name = "lblAbbrev", ;
		TabIndex = 3, ;
		Top = 11, ;
		Width = 37, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblApifuncs' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Apifuncs", ;
		Height = 17, ;
		Left = 534, ;
		Name = "lblApifuncs", ;
		TabIndex = 19, ;
		Top = 196, ;
		Width = 47, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblDescrip' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Descrip", ;
		Height = 17, ;
		Left = 9, ;
		Name = "lblDescrip", ;
		TabIndex = 15, ;
		Top = 55, ;
		Width = 43, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblExample' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Example", ;
		Height = 17, ;
		Left = 534, ;
		Name = "lblExample", ;
		TabIndex = 17, ;
		Top = 295, ;
		Width = 48, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblExpanded' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Expanded", ;
		Left = 226, ;
		Name = "lblExpanded", ;
		TabIndex = 3, ;
		Top = 11, ;
		Width = 55, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblInitflag' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Initflag", ;
		Height = 17, ;
		Left = 502, ;
		Name = "lblInitflag", ;
		TabIndex = 11, ;
		Top = 11, ;
		Width = 36, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblRemarks' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Remarks", ;
		Height = 17, ;
		Left = 11, ;
		Name = "lblRemarks", ;
		TabIndex = 21, ;
		Top = 295, ;
		Width = 51, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblReturnval' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Returnval", ;
		Height = 17, ;
		Left = 534, ;
		Name = "lblReturnval", ;
		TabIndex = 13, ;
		Top = 55, ;
		Width = 52, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblTip' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Parameters", ;
		Height = 17, ;
		Left = 11, ;
		Name = "lblTip", ;
		TabIndex = 5, ;
		Top = 196, ;
		Width = 65, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.txtAbbrev' AS textbox WITH ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.abbrev", ;
		Height = 23, ;
		Left = 9, ;
		MaxLength = 40, ;
		Name = "txtAbbrev", ;
		TabIndex = 4, ;
		Top = 27, ;
		Width = 206
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtExpanded' AS textbox WITH ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.expanded", ;
		Height = 23, ;
		Left = 226, ;
		MaxLength = 40, ;
		Name = "txtExpanded", ;
		TabIndex = 4, ;
		Top = 27, ;
		Width = 267
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtInitflag' AS textbox WITH ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.initflag", ;
		Height = 23, ;
		Left = 502, ;
		MaxLength = 40, ;
		Name = "txtInitflag", ;
		TabIndex = 12, ;
		Top = 27, ;
		Width = 190
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page2.edtTip' AS editbox WITH ;
		Anchor = 15, ;
		Comment = "", ;
		ControlSource = "vfp2cintelli.tip", ;
		Height = 558, ;
		Left = 234, ;
		Name = "edtTip", ;
		TabIndex = 6, ;
		Top = 29, ;
		Width = 823
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page2.Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Parameters", ;
		Left = 17, ;
		Name = "Label1", ;
		TabIndex = 5, ;
		Top = 12, ;
		Width = 65, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page2.lblTip' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Tip", ;
		Left = 235, ;
		Name = "lblTip", ;
		TabIndex = 5, ;
		Top = 12, ;
		Width = 17, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page2.lstParameters' AS listbox WITH ;
		Anchor = 5, ;
		Height = 276, ;
		Left = 15, ;
		Name = "lstParameters", ;
		RowSource = "THISFORM.aParams", ;
		RowSourceType = 5, ;
		Top = 29, ;
		Width = 191
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'Pageframe1.Page3.oBrowser' AS olecontrol WITH ;
		Anchor = 15, ;
		Height = 592, ;
		Left = 0, ;
		Name = "oBrowser", ;
		Top = 0, ;
		Width = 1061
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\ieframe.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOBbHM/218sBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAAAwAAAP7////+////BAAAAP7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9h+VaICjTQEalrAMBP1wWiTAAAAKhtAAAvPQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAA4NBXAHM1zxGuaQgAKy4SYggAAAAAAAAATAAAAAEUAgAAAAAAwAAAAAAAAEaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />
	
	PROCEDURE Init
		LOCAL lcPath
		m.lcPath = SYS(1271, THIS)
		m.lcPath = FULLPATH(JUSTPATH(m.lcPath))
		CD (m.lcPath)
		
		THIS.lstFunctions.ListIndex = 1
		THIS.OnFunctionchange()
	ENDPROC

	PROCEDURE onfilterchange
		LPARAMETERS lcFunction
		THIS.cFilter = THIS.cmbFilter.List[THIS.cmbFilter.ListIndex, 2]
		THIS.lstFunctions.Requery()
		IF VARTYPE(m.lcFunction) = 'C'
			THIS.SelectFunction(m.lcFunction)
		ELSE
			THIS.lstFunctions.Selected[1] = .T.
		ENDIF
		THIS.OnFunctionChange()
	ENDPROC

	PROCEDURE onfunctionchange
		SELECT vfp2cintelli
		LOCATE FOR expanded = This.lstFunctions.Value
		ALINES(THIS.aParams, CHRTRAN(vfp2cintelli.tip, '[]', ''), 1, ',')
		THIS.Pageframe1.Page2.lstParameters.Requery()
		
		DO CASE
			CASE THIS.Pageframe1.ActivePage = 1
				This.Refresh()
			CASE THIS.Pageframe1.ActivePage = 2
				THIS.OnParamchange()
			OTHERWISE
				THIS.RefreshPreview()
		ENDCASE
		
		
	ENDPROC

	PROCEDURE onparamchange
		LOCAL lcTipName, lnParmNo
		
		SELECT vfp2cintelli
		
		IF THISFORM.pageframe1.page2.lstParameters.ListCount = 0
			GO BOTTOM
			SKIP
			RETURN
		ENDIF
		
		m.lnParmNo = THISFORM.pageframe1.page2.lstParameters.ListIndex
		IF m.lnParmNo = 0
			THISFORM.pageframe1.page2.lstParameters.ListIndex = 1
			m.lnParmNo = 1
		ENDIF
		m.lcTipName = SUBSTR(ALLTRIM(THISFORM.lstFunctions.Value), 1, 22) + '_T' + PADL(ALLTRIM(STR(m.lnParmNo)), 2, '0')
		
		LOCATE FOR ALLTRIM(expanded) == m.lcTipName
		IF !FOUND()
			DO updateparmtips.prg WITH THISFORM.lstFunctions.Value
			LOCATE FOR ALLTRIM(expanded) = m.lcTipName
		ENDIF
		THIS.Refresh()
		
	ENDPROC

	PROCEDURE refreshpreview
		DO createHTMLHelp WITH THISFORM.lstFunctions.Value
		
		LOCAL loBrowser
		m.loBrowser = THIS.Pageframe1.page3.oBrowser
		IF LEFT(m.loBrowser.LocationURL, 4) = 'file'
			m.loBrowser.Refresh2()
		ELSE
			m.loBrowser.Navigate2('file://' + FULLPATH(CURDIR()) + 'preview.html')
		ENDIF
		
	ENDPROC

	PROCEDURE selectfunction
		LPARAMETERS lcFunction
		
		LOCAL xj
		
		WITH THIS.lstFunctions
		FOR m.xj = 1 TO .ListCount
			IF ALLTRIM(THIS.lstFunctions.List[m.xj]) == m.lcFunction
				THIS.lstFunctions.Selected[m.xj] = .T.
				EXIT
			ENDIF
		ENDFOR
		ENDWITH
		
		
		
	ENDPROC

	PROCEDURE updateparmtiprecords
	ENDPROC

	PROCEDURE cmbFilter.Init
		THIS.AddItem('')
		THIS.List[THIS.NewIndex, 2] = ''
		SELECT groupname, groupid FROM groups ORDER BY groupname INTO CURSOR tmp_groups
		SELECT tmp_groups
		SCAN
			THIS.AddItem(ALLTRIM(tmp_groups.groupname))
			THIS.List[THIS.NewIndex, 2] = tmp_groups.groupid
		ENDSCAN
		USE IN SELECT('tmp_groups')
	ENDPROC

	PROCEDURE cmbFilter.InteractiveChange
		THISFORM.OnFilterChange()
		
	ENDPROC

	PROCEDURE Command1.Click
		DO createhtmlhelp.prg
	ENDPROC

	PROCEDURE Command3.Click
		LOCAL lcFunc
		m.lcFunc = INPUTBOX('FunctionName', 'Enter name of function', '')
		IF !EMPTY(m.lcFunc)
			m.lcFunc = ALLTRIM(m.lcFunc)
			SELECT vfp2cintelli
			LOCATE FOR ALLTRIM(UPPER(expanded)) == UPPER(m.lcFunc)
			IF FOUND()
				MESSAGEBOX('Function already exists!', 48, 'Ups!')	
				THISFORM.OnFunctionchange()
				RETURN
			ENDIF
			
			APPEND BLANK IN vfp2cintelli
			REPLACE type WITH 'F', abbrev WITH m.lcFunc, expanded WITH m.lcFunc, cmd WITH '{vfp2c32menu}', case WITH 'U', save WITH .F., ;
				 uniqueid WITH SYS(2015), timestamp WITH VFP2C_INTELLI_TIMESTAMP IN vfp2cintelli
		
			THISFORM.cmbFilter.ListIndex = 1
			THISFORM.OnFilterChange(m.lcFunc)
		ENDIF
	ENDPROC

	PROCEDURE lstFunctions.InteractiveChange
		THISFORM.OnFunctionchange()
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.Activate
		THISFORM.OnFunctionchange()
	ENDPROC

	PROCEDURE Pageframe1.Page2.Activate
		THISFORM.OnParamchange()
	ENDPROC

	PROCEDURE Pageframe1.Page2.lstParameters.InteractiveChange
		THISFORM.OnParamChange()
		
	ENDPROC

	PROCEDURE Pageframe1.Page3.Activate
		THISFORM.RefreshPreview()
	ENDPROC

	PROCEDURE Pageframe1.Page3.oBrowser.BeforeNavigate2
		*** ActiveX Control Event ***
		LPARAMETERS pdisp, url, flags, targetframename, postdata, headers, cancel
		LOCAL lcFunction
		IF !('http:' $ m.url) AND !('preview.html' $ m.url)
			m.lcFunction = STREXTRACT(m.url, '\pages\', '.html')
			THISFORM.SelectFunction(m.lcFunction)
			DO createHTMLHelp WITH m.lcFunction
			m.cancel = .T.
			THIS.Refresh2()
		ENDIF
	ENDPROC

ENDDEFINE
