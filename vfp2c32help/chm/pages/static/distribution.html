<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
<title>Distribution</title>
<link href="/scripts/styles.css" rel="stylesheet" type="text/css" />
<script src="/scripts/jscript.js" type="text/javascript"></script>
</head>
<body>
<div id="header">
<p id="vfp2c32version"></p>
<h1>Distribution</h1>
</div>
<div id="content">

<h2>VFP2C32 Package</h2>
<p>The distribution contains the following directories:</p>
<table>
<tr><td>vfp2c32</td><td>Contains the FLL and all supporting files.</td></tr>
<tr><td>vfp2c32examples</td><td>Contains an example project.</td></tr>
<tr><td>vfp2c32front</td><td>VFP2C32 Front is a supporting program which translates C struct, union and enum types into VFP code.</td></tr>
</table>

<h2>Integration into you project</h2>
<p>Add vfp2c32.fll and vfp2c.h to your project - both excluded from the application/executable.<br />
If you need to pass C style arrays to a C library you'll want to have a look at the classes defined in vfp2carray.prg and also include it.</p>
<p>vfp2c32t.fll is the threadsafe version of the library, you can use it in multithreaded VFP COM dlls.</p>

<h2>Initialization/cleanup of the library</h2>

<div class="codeheader"><a onclick="CopyCode('code_33O0ZZMWB')" onmouseover="ChangeClass(this, 'onhover')" onmouseout="ChangeClass(this, '')">Copy code</a></div>
<div class="block"><pre id="code_33O0ZZMWB">&& somewhere at your programs startup code
#INCLUDE vfp2c.h
SET LIBRARY TO vfp2c32.fll ADDITIVE 
IF !InitVFP2C32(VFP2C_INIT_ALL) && you can vary the initialization parameter depending on what functions of the FLL you intend to use
  LOCAL laError[1], lnCount, xj, lcError
  lnCount = AERROREX('laError') 
  lcError = 'VFP2C32 Library initialization failed:' + CHR(13)
  FOR xj = 1 TO lnCount
    lcError = lcError + ;
    'Error No : ' + TRANSFORM(laError[1]) + CHR(13) + ;
    'Function : ' + laError[2] + CHR(13) + ;
    'Message : "' + laError[3] + '"'
  ENDFOR
  && show/log error and abort program initialization ..
ENDIF
</pre></div>

<h2>Deployment</h2>
<p>Just place a copy of vfp2c32.fll/vfp2c32t.fll and msvcr71.dll in your application directory structure, <strong>NOT</strong> in Windows\System32.</p>

</div>
<div id="footer">
<p>© <a href="http://vfpx.codeplex.com/wikipage?title=VFP2C32">VFP2C32</a> - Shared Source License for <a href="http://vfpx.codeplex.com">VFPX</a></p>
</div>
</body>
</html>