<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
<title>IcmpPing</title><link href="/scripts/styles.css" rel="stylesheet" type="text/css" />
<script src="/scripts/jscript.js" type="text/javascript"></script>
</head><body>
<div id="header">
<p id="vfp2c32version"></p>
<h1 class="function">IcmpPing</h1>
<div class="flags"><a class="threadsafe" title="Threadsafe"></a></div>
</div>
<div id="content">
<p class="description">Sends an IPv4 ICMP echo request, also known as ping, and returns any echo response replies.</p>

<div class="block"><pre>IcmpPing(<a href="#p1">cArrayName</a>, <a href="#p2">cHost</a> [, <a href="#p3">nTTL</a> [, <a href="#p4">nTOS</a> [, <a href="#p5">nTimeout</a> [, <a href="#p6">nDatasize</a> [, <a href="#p7">bDontFragment</a> [, <a href="#p8">nPingCount</a>]]]]]])</pre></div>
<h3>Parameters</h3>
<dl class="parm"><dt><a id="p1">cArrayname</a></dt>
<dd><p>On return the array contains the following information:<br />
<br />
If the ping succeeded</p>
<table>
<tr><th style="width: 70px">Column</th><th>Content</th><th style="width: 70px">Datatype</th></tr>
<tr><td>1</td><td>return IP address</td><td>C</td></tr>
<tr><td>2</td><td>Roundtrip time in milliseconds</td><td>N</td></tr>
<tr><td>3</td><td>Status</td><td>N</td></tr>
<tr><td>4</td><td>Data was retrieved back successfully</td><td>L</td></tr>
</table><p><br />
If the ping failed</p>
<table>
<tr><th style="width: 70px">Column</th><th>Content</th></tr>
<tr><td>1</td><td>empty string</td></tr>
<tr><td>2</td><td>-1</td></tr>
<tr><td>3</td><td>-1</td></tr>
<tr><td>4</td><td>.F.</td></tr>
</table></dd></dl>
<dl class="parm"><dt><a id="p2">cHost</a></dt>
<dd><p>Either an IP address or a hostname.<br />
<br />
e.g. "192.168.1.128", "www.google.com"</p>
</dd></dl>
<dl class="parm"><dt><a id="p3">nTTL (optional)</a></dt>
<dd><p>default = 30<br />
<br />
Time To Live for the network packet.</p>
</dd></dl>
<dl class="parm"><dt><a id="p4">nTOS (optional)</a></dt>
<dd><p>default = 0<br />
<br />
Type Of Service.</p>
</dd></dl>
<dl class="parm"><dt><a id="p5">nTimeout (optional)</a></dt>
<dd><p>default = 3000ms <br />
<br />
Timeout in milliseconds.</p>
</dd></dl>
<dl class="parm"><dt><a id="p6">nDatasize (optional)</a></dt>
<dd><p>default = 32 (bytes)<br />
<br />
Number of bytes to send.</p>
</dd></dl>
<dl class="parm"><dt><a id="p7">bDontFragment (optional)</a></dt>
<dd><p>default = .F.<br />
<br />
May the packet be fragmented?</p>
</dd></dl>
<dl class="parm"><dt><a id="p8">nPingCount (optional)</a></dt>
<dd><p>default = 1<br />
<br />
The number of pings to send, each ping result will be stored into a new row of the array.</p>
</dd></dl>
<h2>Return Value</h2>
<p>The number of executed pings.</p>

<h2>See Also</h2>
<h4>Reference</h4>
<p><a href="/pages/aborturldownloadtofileex.html">AbortUrlDownloadToFileEx</a><br />
<a href="/pages/aipaddresses.html">AIpAddresses</a><br />
<a href="/pages/anetfiles.html">ANetFiles</a><br />
<a href="/pages/anetservers.html">ANetServers</a><br />
<a href="/pages/getservertime.html">GetServerTime</a><br />
<a href="/pages/ip2macaddress.html">Ip2MacAddress</a><br />
<a href="/pages/resolvehosttoip.html">ResolveHostToIp</a><br />
<a href="/pages/synctosntpserver.html">SyncToSNTPServer</a><br />
<a href="/pages/urldownloadtofileex.html">UrlDownloadToFileEx</a><br />
</p>
<h4>Used WinApi functions</h4>
<p><a href="http://msdn.microsoft.com/en-us/library/aa366045(VS.85).aspx">IcmpCreateFile</a><br />
<a href="http://msdn.microsoft.com/en-us/library/aa366050(VS.85).aspx">IcmpSendEcho</a><br />
<a href="http://msdn.microsoft.com/en-us/library/aa366043(VS.85).aspx">IcmpCloseHandle</a><br />
<a href="http://msdn.microsoft.com/en-us/library/ms738524(VS.85).aspx">gethostbyname</a></p>


</div>
<div id="footer">
<p>&copy; <a href="https://github.com/ChristianEhlscheid/vfp2c32">VFP2C32</a> - Shared Source License for <a href="https://vfpx.github.io/">VFPX</a></p>
</div>
</body>
</html>